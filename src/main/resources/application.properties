# Nom de l'application
spring.application.name=medi_thech

# Configuration de la base de données
spring.datasource.url=jdbc:postgresql://localhost:5432/mediThech
spring.datasource.username=postgres
spring.datasource.password=faris
#spring.datasource.password=postgres
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
#spring.jpa.show-sql=true

#spring.datasource.url=jdbc:h2:mem:mediThech
#spring.datasource.driverClassName=org.h2.Driver
#spring.datasource.username=admin
#spring.datasource.password=admin
#spring.jpa.database-platform=org.hibernate.dialect.H2Dialect


# Pool de connexions avec HikariCP (optimisation pour les charges variables)
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.connection-timeout=10000

# Optimisations Hibernate
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
# Désactivation du cache de deuxième niveau
spring.jpa.properties.hibernate.cache.use_second_level_cache=false
# Désactivation du cache de requête
spring.jpa.properties.hibernate.cache.use_query_cache=false

# Port du serveur
server.port=8088

# Compression HTTP pour réduire la taille des réponses
server.compression.enabled=true
server.compression.mime-types=text/html,text/css,application/javascript,application/json
server.compression.min-response-size=1024

# Gestion des téléchargements de fichiers
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=100MB

## Loggings (structure et niveau)
#logging.level.org.springframework=INFO
#logging.level.org.springframework.security=INFO
#logging.level.org.springframework.web=INFO
#logging.level.com.example=INFO
#logging.level.root=INFO
logging.file.name=/locasys/logs/digital.log

# Configurations Thymeleaf (si utilisé pour le frontend)
spring.thymeleaf.cache=false
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.servlet.content-type=text/html
spring.thymeleaf.enabled=true

# Configuration des sessions
server.servlet.session.timeout=60m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict

# Configuration Tomcat (Threads et connexions)
server.tomcat.threads.max=200
server.tomcat.accept-count=100
server.tomcat.connection-timeout=5000
server.tomcat.max-connections=10000

# Taille maximale des en-têtes HTTP
server.tomcat.max-http-response-header-size=8192
server.tomcat.max-http-form-post-size=104857600

# Caractères encodés en UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.force=true

# Traçabilité et Audit
server.error.include-message=always

# Spring Batch : Initialisation automatique des tables
spring.batch.jdbc.initialize-schema=always

# Thread virtuels pour la scalabilité (si supporté)
spring.threads.virtual.enabled=true

#Gestion des mail
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.smtp.ssl.protocols=TLSv1.2
spring.mail.username=digitinstitut22@gmail.com
spring.mail.password=uxds pehm injg wwhl
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.enable=false
spring.mail.properties.mail.smtp.timeout=15000
spring.mail.properties.mail.smtp.connectiontimeout=15000
spring.mail.properties.mail.mail.debug=true